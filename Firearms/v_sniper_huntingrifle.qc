// Created by MrFunreal. 

// Note: I would HEAVILY reccomend you to move the $model line to the very bottom of the entire qc file.
// This will make sure the ref pose generated by $UnlockDefineBones will not be looking weird.

	$ModelName "v_models/v_huntingrifle.mdl"
//	$ModelName !/TEMP 						//HLMV will only load custom models if the modelname is unique. Which is that this is for.

$Model Body		CustomMeshHere				//This is the model you're compiling. Will pick DMX over SMD, if both file types exist.
$CDMaterials	"Models/Weapons/Whatever" 	//This is the subfolder of "materials" where your materials and textures will be. Change it to whatever you want.

$TextureGroup "skinfamilies"				//this weapon has skins by default. You can make new skins or just delete this entire thing.
{
	{ "v_sniper_reference"      }
	{ "v_sniper_reference_worn" }
}

$Attachment "muzzlesmoke" "ValveBiped.weapon_bone" 0 3.8 28.1 rotate -90 0 0
$Attachment "forwardnode" "ValveBiped.weapon_bone" 0 3.8 28.1 rotate -90 0 0
$Attachment "muzzle_flash" "ValveBiped.weapon_bone" 0 3.8 28.1 rotate -90 0 0
$Attachment "attach_muzzle" "ValveBiped.weapon_bone" 0 3.8 28.1 rotate -90 0 0
$Attachment "shell" "ValveBiped.weapon_bone" -1.24 4.28 8.73 rotate 0 150 90
$Attachment "flashlight" "ValveBiped.weapon_bone" -1.27 3.59 16.96 rotate -90 -90 0
$Attachment "attach_camera" "ValveBiped.attach_camera" 0 0 0 rotate 0 0 0

// You shouldn't edit anthing in this little box
//--------------------------------------------------------------------------------------
$SurfaceProp "default"
$Contents "solid"
$IllumPosition -3.018 -14.562 -32.009
$MostlyOpaque // Or $Opaque
$CBox 0 0 0 0 0 0
$BBox -9.021 -13.023 -65.8 38.144 6.987 1.781
//--------------------------------------------------------------------------------------

$UnlockDefineBones
$include "Bones.qci" //Make sure to also copy the bones.qci to whatever folder you're using this qc in.

$SectionFrames 30 120

//--------------------------------------------------------------------------------------
// Removed Knee lines, cause the compiler creates its own.
// IT'S UP TO YOU TO ADD PROPER IKRULES WHERE REQUIRED IN ALL $SEQUENCES!
// I've added basic ikrules to most sequences. But use your own brain to figure out if it's the way you want it!
$IKChain "lhand" "ValveBiped.Bip01_L_Hand"
$IKChain "rhand" "ValveBiped.Bip01_R_Hand"

$PoseParameter "ver_aims" -1 1 loop 0
$PoseParameter "move_x" -1 1 loop 0

// $ANIMATIONS - Make sure the actual animation names are as described in this qc!
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
$animation a_idle		anims/idle 			loop ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
$animation a_look_down	anims/lookpose		frames 0 0 subtract a_idle  0
$animation a_look_mid	anims/lookpose		frames 1 1 subtract a_idle  0
$animation a_look_up	anims/lookpose		frames 2 2 subtract a_idle  0
$animation a_run		anims/run.smd		loop

// Once you set the FPS or other stuff in all the following $animation lines below, make of copy of them and change the prefix of the copy from A_ to AL_!
// That way your non_layer and _layer sequences will have the same settings, while also preventing a nasty bug from appearing.
// I could have set these up for you beforehand, but i myself always edit the FPS, so i would always need to edit two lines for that. Just duping and renaming is quicker.
$animation a_deploy 	anims/deploy		FPS 30
$animation a_fire		anims/fire			FPS 30
$animation a_reload		anims/reload		FPS 32
$animation a_melee		anims/melee			FPS 40
$Animation a_hh_ext		anims/hh_ext		FPS 80 frames  0 30	//first frames of this anim.	//	"Helping Hand" and "Item Extend" could be the same pose. Makes animating quicker.
$Animation a_hh_ret		anims/hh_ext		FPS 80 frames 30 60	//last frames of this anim.     //	They're two animations files each. One is "Extend" and immediately "Retract",
$Animation a_hh_idle	anims/hh_idle		FPS 30 loop                                    		//	while the other is "extended hand looping".
$Animation a_it_ext		anims/it_ext		FPS 80 frames  0 30	//first frames of this anim.    //	The Extend/Retract animation is split up using "Frames X Y". It's easier like that.
$Animation a_it_ret		anims/it_ext		FPS 80 frames 30 60	//last frames of this anim.     //
$Animation a_it_idle	anims/it_idle		FPS 30 loop                                         //

// $SEQUENCES
// Edit Fadein/Fadeout and animation events if you want.
// All Hidden sequences are the non_layers you don't need to see in HLMV.
// I took the liberty to add "Subtract a_idle 0 Delta" to every visible $sequence to make blending happen. Delete where you don't want it.
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

$Sequence "a_sniper_arms_vaims"					a_look_down a_look_mid a_look_up 	Hidden	blend "ver_aims" 1 -1	blendwidth 3 delta
$Sequence "sniper_idle"							a_run a_idle a_run 							blend "move_x" -1 1		blendwidth 3 addlayer "a_sniper_arms_vaims" loop "ACT_VM_IDLE_SNIPER" 1

$Sequence "sniper_pickup" 						a_look_mid "ACT_VM_PICKUP_SNIPER" 1 						Hidden	// Unused nonsense
$Sequence "Sniper_pickup_layer" 				a_look_mid "ACT_VM_PICKUP_SNIPER_LAYER" 1 					Hidden	// Unused nonsense
$Sequence "sniper_pickup_partial" 				a_look_mid "ACT_VM_PICKUP_CLIPIN_SNIPER" 1 					Hidden	// Unused nonsense
$Sequence "Sniper_pickup_partial_layer" 		a_look_mid "ACT_VM_PICKUP_CLIPIN_SNIPER_LAYER" 1			Hidden	// Unused nonsense
$Sequence "sniper_pickup_partial2" 				a_look_mid "ACT_VM_PICKUP_CHARGING_SNIPER" 1				Hidden	// Unused nonsense
$Sequence "Sniper_pickup_partial2_layer" 		a_look_mid "ACT_VM_PICKUP_CHARGING_SNIPER_LAYER" 1 			Hidden	// Unused nonsense

$Sequence "sniper_reload1"						a_reload	fadein 0.2	fadeout 0.4 					Hidden 	"ACT_VM_RELOAD_SNIPER" 1
$Sequence "Sniper_reload_layer"					a_reload	fadein 0.2	fadeout 0.4 Subtract a_idle 0	Delta	"ACT_VM_RELOAD_SNIPER_LAYER" 1	{	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
	{ event 5004 18 "HuntingRifle.ClipOut" }
	{ event 5004 61 "HuntingRifle.ClipIn" }
	{ event 5004 80 "HuntingRifle.ClipLocked" }
	{ event AE_RELOAD_CLIPOUT 27 "" } // This is probably a leftover, but i'm keeping it here.
}

$Sequence "sniper_reload_clipout" 				a_look_mid "ACT_VM_RELOAD_CLIPOUT_SNIPER" 1					Hidden	// Unused nonsense
$Sequence "Sniper_reload_clipout_layer" 		a_look_mid "ACT_VM_RELOAD_CLIPOUT_SNIPER_LAYER" 1			Hidden	// Unused nonsense
$Sequence "sniper_reload_empty" 				a_look_mid "ACT_VM_RELOAD_EMPTY_SNIPER" 1					Hidden	// Unused nonsense
$Sequence "Sniper_reload_empty_layer" 			a_look_mid "ACT_VM_RELOAD_EMPTY_SNIPER_LAYER" 1				Hidden	// Unused nonsense
$Sequence "sniper_reload_empty_clipout" 		a_look_mid "ACT_VM_RELOAD_EMPTY_CLIPOUT_SNIPER" 1			Hidden	// Unused nonsense
$Sequence "Sniper_reload_empty_clipout_layer" 	a_look_mid "ACT_VM_RELOAD_EMPTY_CLIPOUT_SNIPER_LAYER" 1		Hidden	// Unused nonsense
$Sequence "sniper_reload_empty_partial" 		a_look_mid "ACT_VM_RELOAD_EMPTY_CLIPIN_SNIPER" 1			Hidden	// Unused nonsense
$Sequence "Sniper_reload_empty_partial_layer" 	a_look_mid "ACT_VM_RELOAD_EMPTY_CLIPIN_SNIPER_LAYER" 1		Hidden	// Unused nonsense

$Sequence "sniper_draw"							a_draw		Snap		fadeout 0.2						Hidden	"ACT_VM_DEPLOY_SNIPER" 1
$Sequence "Sniper_deploy_layer"					al_draw		Snap		fadeout 0.2 Subtract a_idle 0	Delta	"ACT_VM_DEPLOY_SNIPER_LAYER" 1	{	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
	{ event 5004 1 "HuntingRifle.Deploy" }
	{ event 5004 28 "HuntingRifle.BoltBack" }
	{ event 5004 39 "HuntingRifle.BoltForward" }
}

$Sequence "sniper_shoot1"						a_fire		Fadein 0.1	fadeout 0.2						Hidden	"ACT_VM_PRIMARYATTACK_SNIPER" 1
$Sequence "Sniper_shoot_layer"					al_fire		Fadein 0.1	fadeout 0.2 Subtract a_idle 0	Delta	"ACT_VM_SHOOT_SNIPER_LAYER" 1	{	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
	{ event AE_CL_CREATE_PARTICLE_BRASS 2 "weapon_shell_casing_rifle shell" }
	{ event AE_MUZZLEFLASH 0 "1" }
}

$Sequence "sniper_melee"						a_melee		Fadein 0.1	fadeout 0.2						Hidden	"ACT_VM_MELEE_SNIPER" 1
$Sequence "Sniper_melee_layer"					al_melee	Fadein 0.1	fadeout 0.2 Subtract a_idle 0	Delta	"ACT_VM_MELEE_SNIPER_LAYER" 1		ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource

//Extending Hands Begin
$Sequence "sniper_ItemPickup_idle"				 a_it_idle	"ACT_VM_ITEMPICKUP_LOOP_SNIPER" 1 				Hidden	fadein 0.2 	fadeout 0.2 	loop
$Sequence "sniper_ItemPickup_idle_layer"		al_it_idle	"ACT_VM_ITEMPICKUP_LOOP_SNIPER_LAYER" 1 				fadein 0.2 	fadeout 0.2 	loop
$Sequence "sniper_ItemPickup_extend"			 a_it_ext	"ACT_VM_ITEMPICKUP_EXTEND_SNIPER" 1 			Hidden	fadein 0.2 	fadeout 0
$Sequence "sniper_ItemPickup_extend_layer" 		al_it_ext	"ACT_VM_ITEMPICKUP_EXTEND_SNIPER_LAYER" 1				fadein 0.2 	fadeout 0				{ event 5004 1 "HuntingRifle.ItemPickupExtend" }
$Sequence "sniper_ItemPickup_retract"			 a_it_ret	"ACT_VM_ITEMPICKUP_RETRACT_SNIPER" 1 			Hidden	fadein 0 	fadeout 0.4
$Sequence "sniper_ItemPickup_retract_layer"		al_it_ret	"ACT_VM_ITEMPICKUP_RETRACT_SNIPER_LAYER" 1				fadein 0 	fadeout 0.4 			{ event 5004 1 "HuntingRifle.ItemPickupRetract" }
$Sequence "sniper_HelpingHand_idle"				 a_hh_idle	"ACT_VM_HELPINGHAND_LOOP_SNIPER" 1 				Hidden	fadein 0.2 	fadeout 0.2 	loop
$Sequence "sniper_HelpingHand_idle_layer"		al_hh_idle	"ACT_VM_HELPINGHAND_LOOP_SNIPER_LAYER" 1 				fadein 0.2 	fadeout 0.2 	loop
$Sequence "sniper_HelpingHand_extend" 			 a_hh_ext	"ACT_VM_HELPINGHAND_EXTEND_SNIPER" 1 			Hidden	fadein 0.2 	fadeout 0
$Sequence "sniper_HelpingHand_extend_layer" 	al_hh_ext	"ACT_VM_HELPINGHAND_EXTEND_SNIPER_LAYER" 1 				fadein 0.2 	fadeout 0				{ event 5004 1 "HuntingRifle.HelpingHandExtend" }
$Sequence "sniper_HelpingHand_retract"			 a_hh_ret	"ACT_VM_HELPINGHAND_RETRACT_SNIPER" 1 			Hidden	fadein 0 	fadeout 0.2
$Sequence "sniper_HelpingHand_retract_layer" 	al_hh_ret	"ACT_VM_HELPINGHAND_RETRACT_SNIPER_LAYER" 1 			fadein 0 	fadeout 0.4 			{ event 5004 1 "HuntingRifle.HelpingHandRetract" }
//Extending Hands End

//You can add new $SEQUENCES below here. But they'll be buggy when you play online.