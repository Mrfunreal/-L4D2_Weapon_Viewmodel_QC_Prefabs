// Created by MrFunreal. 

	$ModelName "v_models/v_dual_pistolA.mdl"
//	$ModelName !/TEMP 						//HLMV will only load custom models if the modelname is unique. Which is that this is for.

// Note: I would HEAVILY reccomend you to move the $model line to the very bottom of the entire qc file.
// This will make sure the ref pose generated by $UnlockDefineBones will not be looking weird.

$Model Body		CustomMeshHere				//This is the model you're compiling. Will pick DMX over SMD, if both file types exist.
$CDMaterials	"Models/Weapons/Whatever" 	//This is the subfolder of "materials" where your materials and textures will be. Change it to whatever you want.

$Attachment "muzzlesmoke_r" "ValveBiped.weapon_bone" 0.63 3.27 9.82 rotate -90 0 0
$Attachment "muzzlesmoke_l" "ValveBiped.weapon_bone_l" 0 1.75 10.5 rotate 0 0 0
$Attachment "shell_r" "ValveBiped.weapon_bone" 0.5 5 6.5 rotate -20 115 -180
$Attachment "shell_l" "ValveBiped.weapon_bone_l" 0 2.8 6.5 rotate -20 125 -180
$Attachment "attach_shell_eject" "ValveBiped.attach_shell_eject" 0 0 0 rotate 0 0 0
$Attachment "attach_muzzle" "ValveBiped.attach_muzzle" 0 0 0 rotate 0 0 0
$Attachment "flashlight" "ValveBiped.weapon_bone" 0.62 1.52 10.77 rotate -90 0 0
$Attachment "muzzle_flash_r" "ValveBiped.weapon_bone" 0.63 3.27 9.82 rotate -90 0 0
$Attachment "muzzle_flash_l" "ValveBiped.weapon_bone_l" 0.01 1.75 10.19 rotate -90 0 0
$Attachment "attach_camera" "ValveBiped.attach_camera" 0 0 0 rotate 0 0 0

// You shouldn't edit anthing in this little box
//--------------------------------------------------------------------------------------
$SurfaceProp "default"
$Contents "solid"
$IllumPosition 0 0 -31 //IllumPosition changed to be the same as viewmodel arms. This should stop the gun and arms from having different brightness when entering dark areas.
$MostlyOpaque // Or $Opaque
$CBox 0 0 0 0 0 0
$BBox -9.544 -6.844 -63 26.167 7.132 0.614
//--------------------------------------------------------------------------------------

$UnlockDefineBones
$include "Bones.qci" //Make sure to also copy the bones.qci to whatever folder you're using this qc in.

//These definebone lines exist because this model uses them by default. If you don't want these bones, delete these lines.
$DefineBone "ValveBiped.weapon_bone_l" "ValveBiped.Bip01" 20.239162 17.852634 4.889639 -89.999989 -89.745954 0 0 0 0 0 0 0
$DefineBone "ValveBiped.weapon_charger_slide_l" "ValveBiped.weapon_bone_l" 0 1.309483 3.219357 0 0 0 0 0 0 0 0 0
$DefineBone "ValveBiped.weapon_bolt_l" "ValveBiped.weapon_bone_l" 0.000392 1.500416 8.150307 0.047385 -0.640038 1.77939 0 0 0 0 0 0
$DefineBone "ValveBiped.weapon_clip_l" "ValveBiped.weapon_bone_l" 0 0.725847 3.497169 0 0 21.952177 0 0 0 0 0 0
$DefineBone "ValveBiped.weapon_clip_bullets_l" "ValveBiped.weapon_clip_l" 0 0.755871 -0.040497 0 0 0 0 0 0 0 0 0

//--------------------------------------------------------------------------------------
// Removed Knee lines, cause the compiler creates its own.
// IT'S UP TO YOU TO ADD PROPER IKRULES WHERE REQUIRED IN ALL $SEQUENCES!
// I've added basic ikrules to most sequences. But use your own brain to figure out if it's the way you want it!
$IKChain "lhand" "ValveBiped.Bip01_L_Hand"
$IKChain "rhand" "ValveBiped.Bip01_R_Hand"

$PoseParameter "ver_aims" -1 1 loop 0
$PoseParameter "move_x" -1 1 loop 0

// $ANIMATIONS - Make sure the actual animation names are as described in this qc!
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// ikrules of the dial pistols are set up to use weapon bones Weapon_Right and Weapon_Left! Adjust if you need to!
$animation a_idle		anims/idle 			loop		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
$animation a_look_down	anims/lookpose		frames 0 0 subtract a_idle  0
$animation a_look_mid	anims/lookpose		frames 1 1 subtract a_idle  0
$animation a_look_up	anims/lookpose		frames 2 2 subtract a_idle  0
$animation a_run		anims/run.smd		loop

// Once you set the FPS or other stuff in all the following $animation lines below, make of copy of them and change the prefix of the copy from A_ to AL_!
// That way your non_layer and _layer sequences will have the same settings, while also preventing a nasty bug from appearing.
// I could have set these up for you beforehand, but i myself always edit the FPS, so i would always need to edit two lines for that. Just duping and renaming is quicker.
$animation a_idle_dry		anims/idle_dry		FPS 30 frames 0 0 loop //This is a one frame animation of the idle pose with the slide pulled back.
$animation a_deploy 		anims/deploy		FPS 30
$animation a_fire_r			anims/fire_r		FPS 34
$animation a_fire_l			anims/fire_l		FPS 34
$animation a_fire_r_last	anims/fire_r_last	FPS 34 //last shot is the same as default, but the guns slide locks open.
$animation a_fire_l_last	anims/fire_l_last	FPS 34 //last shot is the same as default, but the guns slide locks open.
$animation a_reload			anims/reload		FPS 30
$animation a_reload_empty	anims/reload_empty	FPS 30
$animation a_melee			anims/melee			FPS 30
$Animation a_hh_ext			anims/hh_ext		FPS 30 frames  0 30	//first frames of this anim.	//	"Helping Hand" and "Item Extend" could be the same pose. Makes animating quicker.
$Animation a_hh_ret			anims/hh_ext		FPS 30 frames 30 60	//last frames of this anim.     //	They're two animations files each. One is "Extend" and immediately "Retract",
$Animation a_hh_idle		anims/hh_idle		FPS 30 loop                                    		//	while the other is "extended hand looping".
$Animation a_it_ext			anims/it_ext		FPS 30 frames  0 30	//first frames of this anim.    //	The Extend/Retract animation is split up using "Frames X Y". It's easier like that.
$Animation a_it_ret			anims/it_ext		FPS 35 frames 30 60	//last frames of this anim.     //
$Animation a_it_idle		anims/it_idle		FPS 30 loop                                         //

// $SEQUENCES
// Edit Fadein/Fadeout and animation events if you want.
// All Hidden sequences are the non_layers you don't need to see in HLMV.
// I took the liberty to add "Subtract a_idle 0 Delta" to every visible $sequence to make blending happen. Delete where you don't want it.
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
$Sequence "idle"		a_run a_idle a_run 							blend "move_x" -1 1		blendwidth 3 addlayer "idle_layer" loop "ACT_VM_IDLE" 1		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
$Sequence "idle_layer" 	a_look_down a_look_mid a_look_up 	Hidden	blend "ver_aims" 1 -1	blendwidth 3 delta		//This is actually the lookpose :3

$Sequence "deploy" 						 a_deploy		Snap		Fadeout 0.2						Hidden "ACT_VM_DEPLOY" 1
$Sequence "deploy_layer"				al_deploy 		Snap		Fadeout 0.2 Subtract a_idle 0	Delta  "ACT_VM_DEPLOY_LAYER" 1				{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event 5004 1 "Dualpistol.Deploy" }
	{ event 5004 4 "Dualpistol.SlideBack" }
	{ event 5004 14 "Dualpistol.SlideForward" }
}

$Sequence "fire_right" 					 a_fire_r		Fadein 0.1	Fadeout 0.2 					Hidden 	"ACT_VM_PRIMARYATTACK" 1
$Sequence "fire_right_layer"			al_fire_r		Fadein 0.1	Fadeout 0.2 Subtract a_idle 0	Delta  	"ACT_VM_PRIMARYATTACK_LAYER" 1		{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event AE_MUZZLEFLASH 0 "1" }
	{ event AE_CL_CREATE_PARTICLE_BRASS 1 "weapon_shell_casing_9mm_L4D2_fp shell_r" }
}

$Sequence "fire_left" 					 a_fire_l		Fadein 0.1	Fadeout 0.2 					Hidden 	"ACT_VM_SECONDARYATTACK" 1
$Sequence "fire_left_layer"				al_fire_l		Fadein 0.1	Fadeout 0.2 Subtract a_idle 0	Delta  	"ACT_VM_SECONDARYATTACK_LAYER" 1	{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event AE_MUZZLEFLASH 0 "1" }
	{ event AE_CL_CREATE_PARTICLE_BRASS 1 "weapon_shell_casing_9mm_L4D2_fp shell_l" }
}

$Sequence "reload"						 a_reload		Fadein 0.05	Fadeout 0.2 					Hidden 	"ACT_VM_RELOAD" 1
$Sequence "reload_layer" 				al_reload		Fadein 0.05	Fadeout 0.2 Subtract a_idle 0	Delta  	"ACT_VM_RELOAD_LAYER" 1				{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event 5004 7 "Dualpistol.ClipOut" }
	{ event 5004 9 "Dualpistol.ClipOut" }
	{ event 5004 27 "Dualpistol.ClipIn" }
	{ event 5004 35 "Dualpistol.ClipLocked" }
	{ event 5004 52 "Dualpistol.ClipIn" }
	{ event 5004 55 "Dualpistol.ClipLocked" }
}

$Sequence "reload_empty"				 a_reload_empty	Fadein 0	Fadeout 0.2 					Hidden 	"ACT_VM_RELOAD_EMPTY" 1
$Sequence "reload_empty_layer" 			al_reload_empty	Fadein 0	Fadeout 0.2 Subtract a_idle 0	Delta  	"ACT_VM_RELOAD_EMPTY_LAYER" 1		{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event 5004 7 "Dualpistol.ClipOut" 	}
	{ event 5004 9 "Dualpistol.ClipOut" 	}
	{ event 5004 29 "Dualpistol.ClipIn" 	}
	{ event 5004 36 "Dualpistol.ClipLocked"	 }
	{ event 5004 50 "Dualpistol.ClipIn" 	}
	{ event 5004 53 "Dualpistol.ClipLocked"	 }
	{ event 5004 63 "Dualpistol.SlideForward"	 }
	{ event 5004 65 "Dualpistol.SlideForward"	 }
}

$Sequence "fire_last_right" 			 a_fire_r_last	Fadein 0.1	Fadeout 0	 					Hidden 	"ACT_VM_PRIMARYATTACK" 1
$Sequence "fire_last_right_layer"		al_fire_r_last	Fadein 0.1	Fadeout 0	 Subtract a_idle 0	Delta  	"ACT_VM_DRYFIRE" 1					{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event AE_MUZZLEFLASH 0 "1" }
	{ event AE_CL_CREATE_PARTICLE_BRASS 1 "weapon_shell_casing_9mm_L4D2_fp shell_r" }
}

$Sequence "fire_last_left" 			 	 a_fire_l_last	Fadein 0.1	Fadeout 0	 					Hidden 	"ACT_VM_PRIMARYATTACK" 1
$Sequence "fire_last_left_layer"		al_fire_l_last	Fadein 0.1	Fadeout 0	 Subtract a_idle 0	Delta  	"ACT_VM_DRYFIRE_LEFT" 1				{		ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource
	{ event AE_MUZZLEFLASH 0 "1" }
	{ event AE_CL_CREATE_PARTICLE_BRASS 1 "weapon_shell_casing_9mm_L4D2_fp shell_l" }
}

$Sequence "dry_right_idle"				 a_idle_dry		Fadein 0	Fadeout 0						Hidden
$Sequence "dry_right_idle_layer"		al_idle_dry		Fadein 0	Fadeout 0	Subtract a_idle 0	Delta	"ACT_VM_IDLE_LOWERED" 1 					ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource

$Sequence "melee"		 				 a_melee		Fadein 0	Fadeout 0.2 					Hidden 	"ACT_VM_MELEE" 1
$Sequence "melee_layer"  				al_melee		Fadein 0	Fadeout 0.2 Subtract a_idle 0 	Delta  	"ACT_VM_MELEE_LAYER" 1						ikrule rhand touch Weapon_Right usesource ikrule lhand touch Weapon_Left usesource

//Extending Hands Begin
$Sequence "helping_hand_extend" 		 a_hh_ext	"ACT_VM_HELPINGHAND_EXTEND" 1 			Hidden
$Sequence "helping_hand_extend_layer" 	al_hh_ext	"ACT_VM_HELPINGHAND_EXTEND_LAYER" 1 			Fadein 0.2 	Fadeout 0 				{ event 5004 1 "DualPistol.HelpingHandExtend" }
$Sequence "helping_hand_loop" 			 a_hh_idle	"ACT_VM_HELPINGHAND_LOOP" 1 			Hidden
$Sequence "helping_hand_loop_layer" 	al_hh_idle	"ACT_VM_HELPINGHAND_LOOP_LAYER" 1 				Fadein 0.2 	Fadeout 0.2 	loop
$Sequence "helping_hand_retract" 		 a_hh_ret	"ACT_VM_HELPINGHAND_RETRACT" 1 			Hidden
$Sequence "helping_hand_retract_layer" 	al_hh_ret	"ACT_VM_HELPINGHAND_RETRACT_LAYER" 1 			Fadein 0 	Fadeout 0.2 			{ event 5004 1 "DualPistol.HelpingHandRetract" }
$Sequence "item_extend" 				 a_it_ext	"ACT_VM_ITEMPICKUP_EXTEND" 1 			Hidden
$Sequence "item_extend_layer" 			al_it_ext	"ACT_VM_ITEMPICKUP_EXTEND_LAYER" 1 				Fadein 0.2 	Fadeout 0 				{ event 5004 1 "DualPistol.ItemPickupExtend" }
$Sequence "item_loop" 					 a_it_idle	"ACT_VM_ITEMPICKUP_LOOP" 1 				Hidden
$Sequence "item_loop_layer" 			al_it_idle	"ACT_VM_ITEMPICKUP_LOOP_LAYER" 1 				Fadein 0.2 	Fadeout 0.2 	loop
$Sequence "item_retract" 				 a_it_ret	"ACT_VM_ITEMPICKUP_RETRACT" 1 			Hidden
$Sequence "item_retract_layer"  		al_it_ret	"ACT_VM_ITEMPICKUP_RETRACT_LAYER" 1 			Fadein 0 	Fadeout 0.2 			{ event 5004 1 "DualPistol.ItemPickupRetract" }
//Extending Hands End

//You can add new $SEQUENCES below here. But they'll be buggy when you play online.
