// Created by MrFunreal.

// Note: I would HEAVILY reccomend you to move the $model line to the very bottom of the entire qc file.
// This will make sure the ref pose generated by $UnlockDefineBones will not be looking weird.

	$ModelName "v_models/v_pipebomb.mdl"
//	$ModelName !/TEMP 						//HLMV will only load custom models if the modelname is unique. Which is that this is for.

$Model Body		CustomMeshHere				//This is the model you're compiling. Will pick DMX over SMD, if both file types exist.
$CDMaterials	"Models/Weapons/Whatever" 	//This is the subfolder of "materials" where your materials and textures will be. Change it to whatever you want.

$Attachment "fuse" "ValveBiped.jiggle_fuse2" -0.04 0 1.03 rotate -88.98 -180 90 //Don't delete this. You MUST have this. IF you don't want it, move it behind the camera.

// You shouldn't edit anthing in this little box
//--------------------------------------------------------------------------------------
$SurfaceProp "default"
$Contents "solid"
$IllumPosition -2.128 -17.406 -29.139
$MostlyOpaque // Or $Opaque$CBox 0 0 0 0 0 0
$BBox 0.174 -17.348 -62 34.638 13.092 3.722
//--------------------------------------------------------------------------------------

$UnlockDefineBones
$include "Bones.qci" //Make sure to also copy the bones.qci to whatever folder you're using this qc in.

//These definebone lines exist because this model uses them by default. If you don't want these bones, delete these lines.
$DefineBone "ValveBiped.fuse_root" "ValveBiped.weapon_bone" 0.019982 4.983177 0 0 -20.154247 -89.999982 0 0 0 0 0 0
$DefineBone "ValveBiped.jiggle_fuse0" "ValveBiped.fuse_root" -0.06761 0 0.285728 -0.000002 0 0 0 0 0 0 0 0
$DefineBone "ValveBiped.jiggle_fuse1" "ValveBiped.jiggle_fuse0" -0.009274 -0.000004 0.938381 19.202795 0 0 0 0 0 0 0 0
$DefineBone "ValveBiped.jiggle_fuse2" "ValveBiped.jiggle_fuse1" -0.028078 0 1.055857 22.801649 0 0 0 0 0 0 0 0

//i'm keeping the jiggelbone data here in case you want to re.use them.
$JiggleBone "ValveBiped.jiggle_fuse0"
{
	is_flexible
	{
		length 300
		tip_mass 0
		pitch_stiffness 400
		pitch_damping 10
		yaw_stiffness 400
		yaw_damping 10
		along_stiffness 100
		along_damping 0
		angle_constraint 39.999999
	}
}
$JiggleBone "ValveBiped.jiggle_fuse1"
{
	is_flexible
	{
		length 300
		tip_mass 0
		pitch_stiffness 400
		pitch_damping 10
		yaw_stiffness 400
		yaw_damping 10
		along_stiffness 100
		along_damping 0
		angle_constraint 39.999999
	}
}
//--------------------------------------------------------------------------------------
//	The following few lines would sometimes create an .ani file to keep anims in. You don't need them and could delete them.
	$AnimBlockSize 32 nostall
	$BoneSaveFrame "ValveBiped.ValveBiped" position
	$BoneSaveFrame "ValveBiped.weapon_bone" position
	$BoneSaveFrame "ValveBiped.Bip01_Spine" position
	$BoneSaveFrame "ValveBiped.Bip01_L_Clavicle" position
	$BoneSaveFrame "ValveBiped.Bip01_R_Clavicle" position
	$SectionFrames 30 160
//--------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------
// Removed Knee lines, cause the compiler creates its own.
// IT'S UP TO YOU TO ADD PROPER IKRULES WHERE REQUIRED IN ALL $SEQUENCES!
// I've added basic ikrules to most sequences. But use your own brain to figure out if it's the way you want it!
$IKChain "lhand" "ValveBiped.Bip01_L_Hand"
$IKChain "rhand" "ValveBiped.Bip01_R_Hand"

$PoseParameter "ver_aims" -1 1 loop 0
$PoseParameter "move_x" -1 1 loop 0

// $ANIMATIONS - Make sure the actual animation names are as described in this qc!
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
$animation a_idle		anims/idle 		loop ikrule rhand touch weapon usesource ikrule lhand touch weapon usesource
$animation a_look_down	anims/lookpose	frames 0 0 subtract a_idle  0
$animation a_look_mid	anims/lookpose	frames 1 1 subtract a_idle  0
$animation a_look_up	anims/lookpose	frames 2 2 subtract a_idle  0
$animation a_run		anims/run.smd	loop

// Once you set all the following $Animation's up (including the helping hands), Duplicate them and change the suffix from A_ to AL_.
// So you'll have two animation blocks identical, except for the prefix. Like A_Deploy and AL_Depoloy.
$animation a_deploy		anims/deploy 	fps 50
$animation a_pullpin	anims/pullpin	fps 40
$animation a_throw		anims/throw		fps 40
$animation a_melee		anims/melee		fps 40

$animation a_hh_ext		anims/hh_ext	fps 80 frames 0 30 //first 30 frames of this anim.	//	"Helping Hand" and "Item Extend" could be the same pose. Makes animating quicker.
$animation a_hh_ret		anims/hh_ext	fps 80 frames 30 0 //last 30 frames of this anim.   //	They're two animations files each. One is "Extend" and immediately "Retract",
$animation a_hh_idle	anims/hh_idle	fps 30 loop                                         //	while the other is "extended hand looping".
$animation a_it_ext		anims/it_ext	fps 80 frames 0 30 //first 30 frames of this anim.  //	The Extend/Retract animation is split up using "Frames X Y". It's easier like that
$animation a_it_ret		anims/it_ext	fps 80 frames 30 0 //last 30 frames of this anim.   //
$animation a_it_idle	anims/it_idle	fps 30 loop                                         //

// $SEQUENCES
// Edit Fadein/Fadeout and animation events if you want.
// All Hidden sequences are the non_layers you don't need to see in HLMV. (Except for lookpose)
// I took the liberty to add "Subtract a_idle 0 Delta" to every visible $sequence to make blending happen. Delete where you don't want it.
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
$Sequence "a_molotov_arms_vaims"	a_look_down a_look_mid a_look_up													Hidden	blend "ver_aims" 1 -1		blendwidth 3	delta
$Sequence "pipebomb_idle"			a_run a_idle a_run					"ACT_VM_IDLE_PIPEBOMB" 1								blend "move_x" 1 -1			blendwidth 3	addlayer "a_molotov_arms_vaims" loop
$Sequence "pipebomb_deploy"							 a_deploy			"ACT_VM_DEPLOY_PIPEBOMB" 1						Hidden
$Sequence "pipebomb_deploy_layer"					al_deploy			"ACT_VM_DEPLOY_PIPEBOMB_LAYER" 1						snap		fadeout 0.6 	subtract a_idle 0 delta	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
$Sequence "pipebomb_pullpin"						 a_pullpin			"ACT_VM_PULLPIN_PIPEBOMB" 1						Hidden
$Sequence "pipebomb_pullpin_layer"					al_pullpin			"ACT_VM_PULLPIN_PIPEBOMB_LAYER" 1						fadein 0.2	fadeout 0.2 	subtract a_idle 0 delta	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
$Sequence "pipebomb_throw"							 a_throw			"ACT_VM_THROW_PIPEBOMB" 1						Hidden
$Sequence "pipebomb_throw_layer"					al_throw			"ACT_VM_THROW_PIPEBOMB_LAYER" 1							fadein 0.2	fadeout 0.2 	subtract a_idle 0 delta	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
$Sequence "pipebomb_melee"							 a_melee			"ACT_VM_MELEE_PIPEBOMB" 1						Hidden
$Sequence "pipebomb_melee_layer"					al_melee			"ACT_VM_MELEE_PIPEBOMB_LAYER" 1							fadein 0.1	fadeout 0.4 	subtract a_idle 0 delta	ikrule rhand touch Weapon usesource ikrule lhand touch Weapon usesource
//Extending Hands Begin
$Sequence "eq_pipebomb_ItemPickup_idle" 			 a_it_idle			"ACT_VM_ITEMPICKUP_LOOP_PIPEBOMB" 1 			Hidden
$Sequence "eq_pipebomb_ItemPickup_idle_layer" 		al_it_idle			"ACT_VM_ITEMPICKUP_LOOP_PIPEBOMB_LAYER" 1 				fadein 0.2 	fadeout 0.2 loop
$Sequence "eq_pipebomb_ItemPickup_extend" 			 a_it_ext			"ACT_VM_ITEMPICKUP_EXTEND_PIPEBOMB" 1 			Hidden
$Sequence "eq_pipebomb_ItemPickup_extend_layer" 	al_it_ext			"ACT_VM_ITEMPICKUP_EXTEND_PIPEBOMB_LAYER" 1 			fadein 0.2 	fadeout 0	 	{ event 5004 1 "PipeBomb.ItemPickupExtend" }
$Sequence "eq_pipebomb_ItemPickup_retract" 			 a_it_ret			"ACT_VM_ITEMPICKUP_RETRACT_PIPEBOMB" 1 			Hidden
$Sequence "eq_pipebomb_ItemPickup_retract_layer" 	al_it_ret			"ACT_VM_ITEMPICKUP_RETRACT_PIPEBOMB_LAYER" 1 	        fadein 0 	fadeout 0.3 	{ event 5004 1 "PipeBomb.ItemPickupRetract" }
$Sequence "eq_pipebomb_HelpingHand_idle"			 a_hh_idle			"ACT_VM_HELPINGHAND_LOOP_PIPEBOMB" 1 			Hidden
$Sequence "eq_pipebomb_HelpingHand_idle_layer"		al_hh_idle			"ACT_VM_HELPINGHAND_LOOP_PIPEBOMB_LAYER" 1 		        fadein 0.2 	fadeout 0.2 loop
$Sequence "eq_pipebomb_HelpingHand_extend"			 a_hh_ext			"ACT_VM_HELPINGHAND_EXTEND_PIPEBOMB" 1 			Hidden
$Sequence "eq_pipebomb_HelpingHand_extend_layer"	al_hh_ext			"ACT_VM_HELPINGHAND_EXTEND_PIPEBOMB_LAYER" 1 	        fadein 0.2 	fadeout 0	 	{ event 5004 1 "PipeBomb.HelpingHandExtend" }
$Sequence "eq_pipebomb_HelpingHand_retract"			 a_hh_ret			"ACT_VM_HELPINGHAND_RETRACT_PIPEBOMB" 1 		Hidden
$Sequence "eq_pipebomb_HelpingHand_retract_layer"	al_hh_ret			"ACT_VM_HELPINGHAND_RETRACT_PIPEBOMB_LAYER" 1 			fadein 0	fadeout 0.3 	{ event 5004 1 "PipeBomb.HelpingHandRetract" }
//Extending Hands End
//You can add new $SEQUENCES below here. But they'll be buggy when you play online.